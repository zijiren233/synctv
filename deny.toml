# cargo-deny configuration
# https://github.com/EmbarkStudios/cargo-deny

# Security advisories configuration
[advisories]
# The path where the advisory databases are cloned
db-path = "~/.cargo/advisory-dbs"
# The url(s) of the advisory databases to clone/fetch
db-urls = ["https://github.com/rustsec/advisory-db"]
# Fail the build on security vulnerabilities
vulnerability = "deny"
# Warn on unmaintained crates
unmaintained = "warn"
# Warn on unsound crates
unsound = "warn"
# Warn on yanked crates
yanked = "warn"
# Warn on security notices
notice = "warn"
# Ignore specific advisories (use sparingly, document reasons)
ignore = [
    # Example: "RUSTSEC-2020-0001",  # Reason for ignoring
]

# License configuration
[licenses]
# Fail on crates without a license
unlicensed = "deny"
# Allow only specific licenses
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Unicode-DFS-2016",
    "OpenSSL",
    "Zlib",
]
# Deny copyleft licenses (GPL, LGPL, AGPL)
copyleft = "deny"
# Allow FSF/OSI approved licenses by default
allow-osi-fsf-free = "neither"
# Clarification for dual-licensed crates
[[licenses.clarify]]
name = "ring"
expression = "MIT AND ISC AND OpenSSL"
license-files = [
    { path = "LICENSE", hash = 0xbd0eed23 }
]

# Bans configuration - restrict specific crates
[bans]
# Warn on multiple versions of the same dependency
multiple-versions = "warn"
# Deny wildcard dependencies
wildcards = "deny"
# Allow Git dependencies (but log them for review)
allow-wildcard-paths = false
# Skip checking dev dependencies
skip = []
# Skip checking build dependencies
skip-tree = []

# Deny specific crates (with reasons)
deny = [
    # Example: { name = "openssl", reason = "Use rustls instead" },
]

# Sources configuration - control where dependencies come from
[sources]
# Deny dependencies from unknown registries
unknown-registry = "deny"
# Warn on Git dependencies (should be audited)
unknown-git = "warn"
# Only allow crates.io as the registry
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
# Allow specific Git repositories (if needed)
allow-git = [
    "https://github.com/harlanc/xiu.git",  # Used for streaming functionality
]
